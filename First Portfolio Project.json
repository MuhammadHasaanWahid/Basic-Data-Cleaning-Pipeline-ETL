{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"factoryName":{"type":"string","metadata":"Data Factory name"},"AzureDataLakeStorage":{"type":"string"},"AzureSqlDatabaseNEWDB":{"type":"string"}},"variables":{"factoryId":"[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"},"resources":[{"name":"[concat(parameters('factoryName'), '/First Portfolio Project')]","type":"Microsoft.DataFactory/factories/pipelines","apiVersion":"2018-06-01","properties":{"activities":[{"name":"FirstProject","type":"ExecuteDataFlow","dependsOn":[],"policy":{"timeout":"0.12:00:00","retry":0,"retryIntervalInSeconds":30,"secureOutput":false,"secureInput":false},"userProperties":[],"typeProperties":{"dataflow":{"referenceName":"portfolio1","type":"DataFlowReference","parameters":{},"datasetParameters":{"EngCSV":{},"ItaliaCSV":{},"Destination":{}},"linkedServiceParameters":{}},"staging":{"folderPath":"synapse"},"compute":{"coreCount":8,"computeType":"General"},"traceLevel":"Fine"}}],"policy":{"elapsedTimeMetric":{},"cancelAfter":{}},"annotations":[]},"dependsOn":["[concat(variables('factoryId'), '/dataflows/portfolio1')]"]},{"name":"[concat(parameters('factoryName'), '/portfolio1')]","type":"Microsoft.DataFactory/factories/dataflows","apiVersion":"2018-06-01","properties":{"type":"MappingDataFlow","typeProperties":{"sources":[{"dataset":{"referenceName":"DelimitedText1","type":"DatasetReference"},"name":"EngCSV"},{"dataset":{"referenceName":"DelimitedText2","type":"DatasetReference"},"name":"ItaliaCSV"}],"sinks":[{"dataset":{"referenceName":"AzureSqlTable3","type":"DatasetReference"},"name":"Destination"}],"transformations":[{"name":"Joinfull"},{"name":"DeletingUnnecessaryColumns"},{"name":"RemovingNulls"}],"scriptLines":["source(output(","          filmtv_id as string,","          title as string,","          year as string,","          genre as string,","          Prop_4 as string,","          Prop_5 as string,","          Prop_6 as string,","          Prop_7 as string,","          Prop_8 as string,","          Prop_9 as string,","          Prop_10 as string,","          Prop_11 as string,","          Prop_12 as string,","          Prop_13 as string,","          Prop_14 as string,","          Prop_15 as string,","          Prop_16 as string,","          Prop_17 as string","     ),","     allowSchemaDrift: true,","     validateSchema: false,","     ignoreNoFilesFound: false) ~> EngCSV","source(output(","          filmtv_id as string,","          titolo_italiano as string,","          durata as string,","          paese as string,","          registi as string,","          attori as string,","          voto_medio as string,","          voto_critica as string,","          voto_pubblico as string,","          voti_totali as string,","          descrizione as string,","          note as string,","          humor as string,","          ritmo as string,","          impegno as string,","          tensione as string,","          erotismo as string","     ),","     allowSchemaDrift: true,","     validateSchema: false,","     ignoreNoFilesFound: false) ~> ItaliaCSV","EngCSV, ItaliaCSV join(EngCSV@filmtv_id == ItaliaCSV@filmtv_id,","     joinType:'outer',","     matchType:'exact',","     ignoreSpaces: false,","     broadcast: 'auto')~> Joinfull","Joinfull select(mapColumn(","          filmtv_id = EngCSV@filmtv_id,","          title,","          year,","          genre,","          filmtv_id = ItaliaCSV@filmtv_id,","          titolo_italiano,","          durata,","          paese,","          registi,","          attori,","          voto_medio,","          voto_critica,","          voto_pubblico,","          voti_totali,","          descrizione,","          note,","          humor,","          ritmo,","          impegno,","          tensione,","          erotismo","     ),","     skipDuplicateMapInputs: true,","     skipDuplicateMapOutputs: true) ~> DeletingUnnecessaryColumns","DeletingUnnecessaryColumns alterRow(deleteIf(isNull(filmtv_id))) ~> RemovingNulls","RemovingNulls sink(allowSchemaDrift: true,","     validateSchema: false,","     input(","          filmtv_id as string,","          title as string,","          year as string,","          genre as string,","          titolo_italiano as string,","          durata as string,","          paese as string,","          registi as string,","          attori as string,","          voto_medio as string,","          voto_critica as string,","          voto_pubblico as string,","          voti_totali as string,","          descrizione as string,","          note as string,","          humor as string,","          ritmo as string,","          impegno as string,","          tensione as string,","          erotismo as string","     ),","     deletable:false,","     insertable:true,","     updateable:false,","     upsertable:false,","     format: 'table',","     skipDuplicateMapInputs: true,","     skipDuplicateMapOutputs: true,","     errorHandlingOption: 'stopOnFirstError') ~> Destination"]}},"dependsOn":["[concat(variables('factoryId'), '/datasets/DelimitedText1')]","[concat(variables('factoryId'), '/datasets/DelimitedText2')]","[concat(variables('factoryId'), '/datasets/AzureSqlTable3')]"]},{"name":"[concat(parameters('factoryName'), '/DelimitedText1')]","type":"Microsoft.DataFactory/factories/datasets","apiVersion":"2018-06-01","properties":{"linkedServiceName":{"referenceName":"[parameters('AzureDataLakeStorage')]","type":"LinkedServiceReference"},"annotations":[],"type":"DelimitedText","typeProperties":{"location":{"type":"AzureBlobFSLocation","fileName":"filmtv_movies - ENG.csv","folderPath":"csv data","fileSystem":"data"},"columnDelimiter":",","escapeChar":"\\","firstRowAsHeader":true,"quoteChar":"\""},"schema":[{"name":"filmtv_id","type":"String"},{"name":"title","type":"String"},{"name":"year","type":"String"},{"name":"genre","type":"String"},{"name":"Prop_4","type":"String"},{"name":"Prop_5","type":"String"},{"name":"Prop_6","type":"String"},{"name":"Prop_7","type":"String"},{"name":"Prop_8","type":"String"},{"name":"Prop_9","type":"String"},{"name":"Prop_10","type":"String"},{"name":"Prop_11","type":"String"},{"name":"Prop_12","type":"String"},{"name":"Prop_13","type":"String"},{"name":"Prop_14","type":"String"},{"name":"Prop_15","type":"String"},{"name":"Prop_16","type":"String"},{"name":"Prop_17","type":"String"}]},"dependsOn":[]},{"name":"[concat(parameters('factoryName'), '/DelimitedText2')]","type":"Microsoft.DataFactory/factories/datasets","apiVersion":"2018-06-01","properties":{"linkedServiceName":{"referenceName":"[parameters('AzureDataLakeStorage')]","type":"LinkedServiceReference"},"annotations":[],"type":"DelimitedText","typeProperties":{"location":{"type":"AzureBlobFSLocation","fileName":"filmtv_movies - ITA.csv","folderPath":"csv data","fileSystem":"data"},"columnDelimiter":",","escapeChar":"\\","firstRowAsHeader":true,"quoteChar":"\""},"schema":[{"name":"filmtv_id","type":"String"},{"name":"titolo_italiano","type":"String"},{"name":"durata","type":"String"},{"name":"paese","type":"String"},{"name":"registi","type":"String"},{"name":"attori","type":"String"},{"name":"voto_medio","type":"String"},{"name":"voto_critica","type":"String"},{"name":"voto_pubblico","type":"String"},{"name":"voti_totali","type":"String"},{"name":"descrizione","type":"String"},{"name":"note","type":"String"},{"name":"humor","type":"String"},{"name":"ritmo","type":"String"},{"name":"impegno","type":"String"},{"name":"tensione","type":"String"},{"name":"erotismo","type":"String"}]},"dependsOn":[]},{"name":"[concat(parameters('factoryName'), '/AzureSqlTable3')]","type":"Microsoft.DataFactory/factories/datasets","apiVersion":"2018-06-01","properties":{"linkedServiceName":{"referenceName":"[parameters('AzureSqlDatabaseNEWDB')]","type":"LinkedServiceReference"},"annotations":[],"type":"AzureSqlTable","schema":[{"name":"filmtv_id","type":"nvarchar"},{"name":"title","type":"nvarchar"},{"name":"year","type":"nvarchar"},{"name":"genre","type":"nvarchar"},{"name":"titolo_italiano","type":"nvarchar"},{"name":"durata","type":"nvarchar"},{"name":"paese","type":"nvarchar"},{"name":"registi","type":"nvarchar"},{"name":"attori","type":"nvarchar"},{"name":"voto_medio","type":"nvarchar"},{"name":"voto_critica","type":"nvarchar"},{"name":"voto_pubblico","type":"nvarchar"},{"name":"voti_totali","type":"nvarchar"},{"name":"descrizione","type":"nvarchar"},{"name":"note","type":"nvarchar"},{"name":"humor","type":"nvarchar"},{"name":"ritmo","type":"nvarchar"},{"name":"impegno","type":"nvarchar"},{"name":"tensione","type":"nvarchar"},{"name":"erotismo","type":"nvarchar"}],"typeProperties":{"schema":"dbo","table":"portfoliooneTable"}},"dependsOn":[]}]}